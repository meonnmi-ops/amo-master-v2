<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOYAGER V19.0 - SERVER DATA ONLY</title>
    <style>
        :root { --gold: #d4af37; --bg: #050505; --card: #111; --modern: #00d2ff; --internet: #9d50bb; --taiwan: #ff9f43; --success: #2ecc71; --danger: #ff4757; }
        body { background-color: var(--bg); color: #eee; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; }
        .master-container { width: 100%; max-width: 480px; background: #000; border: 1.5px solid #222; border-radius: 40px; padding: 15px; box-sizing: border-box; margin: auto; }
        .tab-nav { display: flex; gap: 10px; margin-bottom: 20px; position: sticky; top: 0; background: #000; padding: 10px 0; z-index: 100; }
        .tab-btn { flex: 1; padding: 12px; border-radius: 12px; border: 1px solid #333; background: #111; color: #666; cursor: pointer; font-weight: bold; font-size: 11px; }
        .tab-btn.active { background: var(--gold); color: #000; border-color: var(--gold); }
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .live-hero { background: #080808; border-radius: 30px; padding: 20px; text-align: center; border-bottom: 2px solid var(--gold); margin-bottom: 15px; }
        .main-num { font-size: 70px; font-weight: 900; color: var(--success); font-family: 'Orbitron'; }
        .layer-title { font-size: 11px; font-weight: bold; margin: 15px 0 10px; color: var(--gold); border-left: 3px solid var(--gold); padding-left: 10px; text-transform: uppercase; }
        .pair-layer { background: var(--card); border-radius: 20px; padding: 12px; border: 1px solid #222; margin-bottom: 10px; }
        .pair-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; text-align: center; }
        .pair-box { padding: 10px; border-radius: 12px; background: #000; border: 1px solid #1a1a1a; }
        .pair-val { font-size: 28px; font-weight: 900; font-family: 'Orbitron'; }
        .pair-label { font-size: 9px; color: #555; display: block; margin-bottom: 4px; }
        .history-card { background: var(--card); border-radius: 20px; padding: 10px; border: 1px solid #222; margin-bottom: 20px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 11px; text-align: center; min-width: 300px; }
        th { color: #555; padding: 8px; font-size: 10px; border-bottom: 1px solid #222; }
        td { padding: 12px 5px; border-bottom: 1px solid #151515; font-weight: bold; }
        .date-txt { color: #666; font-weight: normal; font-size: 10px; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
</head>
<body>

<div class="master-container">
    <div class="tab-nav">
        <button class="tab-btn active" onclick="openPage('live-page', this)">LIVE & SESSIONS</button>
        <button class="tab-btn" onclick="openPage('history-page', this)">CALENDAR HISTORY</button>
    </div>

    <div id="live-page" class="page active">
        <div class="live-hero">
            <span style="font-size: 9px; color: #444; letter-spacing: 2px;">2D LIVE</span>
            <div class="main-num" id="live-2d">--</div>
            <div id="live-clock" style="font-size: 9px; color: #333;">--:--:--</div>
        </div>

        <div class="layer-title">3D & TAIWAN (TW)</div>
        <div class="pair-grid" style="margin-bottom: 15px;">
            <div class="pair-box" style="border-top: 2px solid var(--danger);"><span class="pair-label">THAI 3D</span><div class="pair-val" id="live-3d">---</div></div>
            <div class="pair-box" style="border-top: 2px solid var(--taiwan);"><span class="pair-label">TAIWAN 2D</span><div class="pair-val" id="tw-2d" style="color: var(--taiwan);">--</div></div>
        </div>

        <div class="layer-title">Result Confirmation</div>
        <div class="pair-layer" style="border-left: 4px solid var(--gold);">
            <div class="pair-grid">
                <div class="pair-box"><span class="pair-label">MORNING 12:01</span><div class="pair-val" id="res-m" style="color: var(--success);">--</div></div>
                <div class="pair-box"><span class="pair-label">EVENING 04:30</span><div class="pair-val" id="res-e" style="color: var(--gold);">--</div></div>
            </div>
        </div>

        <div class="layer-title">Modern & Internet Pairs</div>
        <div class="pair-layer" style="border-left: 4px solid var(--modern);"><div class="pair-grid">
            <div class="pair-box"><span class="pair-label">09:30 MOD</span><div class="pair-val" id="m-mod">--</div></div>
            <div class="pair-box"><span class="pair-label">02:00 MOD</span><div class="pair-val" id="e-mod">--</div></div>
        </div></div>
        <div class="pair-layer" style="border-left: 4px solid var(--internet);"><div class="pair-grid">
            <div class="pair-box"><span class="pair-label">12:01 INT</span><div class="pair-val" id="m-int">--</div></div>
            <div class="pair-box"><span class="pair-label">04:30 INT</span><div class="pair-val" id="e-int">--</div></div>
        </div></div>
    </div>

    <div id="history-page" class="page">
        <div class="layer-title">Thai 2D History</div>
        <div class="history-card"><table id="thai-table"><thead><tr><th>DATE/TIME</th><th>SET</th><th>VALUE</th><th>2D</th></tr></thead><tbody id="thai-body"></tbody></table></div>
        <div class="layer-title">Taiwan 2D History</div>
        <div class="history-card"><table id="tw-table"><thead><tr><th>DATE</th><th>TAIEX</th><th>VALUE</th><th>2D</th></tr></thead><tbody id="tw-body"></tbody></table></div>
        <div class="layer-title">3D History Records</div>
        <div class="history-card"><table id="threed-table"><thead><tr><th>DATE</th><th>TIME</th><th>RESULT</th></tr></thead><tbody id="threed-body"></tbody></table></div>
    </div>

    <button style="width:100%; padding:15px; background:var(--gold); border:none; border-radius:15px; font-weight:bold; margin-top:10px; cursor:pointer;" onclick="fetchAllData()">REFRESH ALL DATA</button>
</div>

<script>
    const K = "2d33e7fd9cmshed62a232961d59cp1e7e91jsn5690f63247a7";
    const HOST = "myanmar-all-in-one-2d-results.p.rapidapi.com";

    function openPage(pageId, btn) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        btn.classList.add('active');
    }

    async function fetchAllData() {
        try {
            // Live Data Fetching
            const resLive = await fetch(`https://${HOST}/api/v1/live`, { headers: {'x-rapidapi-key': K, 'x-rapidapi-host': HOST} });
            const liveData = (await resLive.json()).data;

            if(liveData) {
                updateUI(liveData);
                // အင်တာနက်ရှိတုန်းရထားတဲ့ server ကလာတဲ့ data အစစ်ကို သိမ်းထားမယ်
                localStorage.setItem('last_live_cache', JSON.stringify(liveData));
            }

            // Calendar Data Fetching
            const resCal = await fetch(`https://${HOST}/api/v1/calendar`, { headers: {'x-rapidapi-key': K, 'x-rapidapi-host': HOST} });
            const calData = await resCal.json();
            updateHistory(calData);
            localStorage.setItem('last_cal_cache', JSON.stringify(calData));

        } catch (e) {
            // အင်တာနက်မရှိလျှင်/Error ဖြစ်လျှင် cache ထဲက server data အစစ်ကို ပြန်ပြမယ်
            const cacheLive = JSON.parse(localStorage.getItem('last_live_cache'));
            const cacheCal = JSON.parse(localStorage.getItem('last_cal_cache'));

            if(cacheLive) {
                updateUI(cacheLive);
                document.getElementById('live-clock').innerText = "OFFLINE (LAST LIVE DATA)";
            } else {
                document.getElementById('live-clock').innerText = "NO INTERNET CONNECTION";
            }
            if(cacheCal) updateHistory(cacheCal);
        }
    }

    function updateUI(data) {
        document.getElementById('live-2d').innerText = data.live || "--";
        document.getElementById('live-clock').innerText = data.current_time || "--:--:--";
        document.getElementById('res-m').innerText = data.mResult || "--";
        document.getElementById('res-e').innerText = data.eResult || "--";
        document.getElementById('m-mod').innerText = data.mModern || "--";
        document.getElementById('e-mod').innerText = data.eModern || "--";
        document.getElementById('m-int').innerText = data.mInternet || "--";
        document.getElementById('e-int').innerText = data.eInternet || "--";
        document.getElementById('tw-2d').innerText = data.tw_result || "--";
        document.getElementById('live-3d').innerText = data.three_d || "---";
    }

    function updateHistory(calData) {
        let thaiHtml = ""; calData.twoDCalendar.slice(0, 10).forEach(r => { thaiHtml += `<tr><td class="date-txt">${r.date}<br>${r.time}</td><td>${r.set}</td><td>${r.value}</td><td style="color:var(--success)">${r.result}</td></tr>`; });
        document.getElementById('thai-body').innerHTML = thaiHtml;
        
        let twHtml = ""; calData.taiWanTwoDCalendar.slice(0, 10).forEach(r => { twHtml += `<tr><td class="date-txt">${r.date}</td><td>${r.taiex}</td><td>${r.value}</td><td style="color:var(--taiwan)">${r.result}</td></tr>`; });
        document.getElementById('tw-body').innerHTML = twHtml;
        
        let threedHtml = ""; calData.threeDCalendar.slice(0, 10).forEach(r => { threedHtml += `<tr><td class="date-txt">${r.date}</td><td>${r.time}</td><td style="color:var(--danger); font-size:18px;">${r.result}</td></tr>`; });
        document.getElementById('threed-body').innerHTML = threedHtml;
    }

    window.onload = fetchAllData;
</script>
</body>
</html>